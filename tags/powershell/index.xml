<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>PowerShell on Andreas Longo</title>
    <link>https://www.andreaslongo.com/tags/powershell/</link>
    <description>Recent content in PowerShell on Andreas Longo</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Mon, 31 Jul 2023 00:00:00 +0000</lastBuildDate><atom:link href="https://www.andreaslongo.com/tags/powershell/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>PowerShell: Fixing terminal input issues</title>
      <link>https://www.andreaslongo.com/blog/powershell-readline-issue-windows/</link>
      <pubDate>Mon, 31 Jul 2023 00:00:00 +0000</pubDate>
      
      <guid>https://www.andreaslongo.com/blog/powershell-readline-issue-windows/</guid>
      <description> When you start PowerShell and you are not able to enter any commands (copy/paste might still work), chances are your PSReadLine module is outdated.
Fix: Update PSReadLine module Get-Module PSReadLine Version 2.0.0 # Open cmd.exe as admin and run: powershell -noprofile -command &amp;#34;Install-Module PSReadLine -Force&amp;#34; Get-Module PSReadLine Version 2.2.6 </description>
      <content:encoded><![CDATA[<div class="paragraph">
<p>When you start PowerShell and you are not able to enter any commands (copy/paste might still work), chances are your <a href="https://github.com/PowerShell/PSReadLine">PSReadLine</a> module is outdated.</p>
</div>
<div class="listingblock">
<div class="title">Fix: Update PSReadLine module</div>
<div class="content">
<pre class="highlight"><code class="language-powershell" data-lang="powershell">Get-Module PSReadLine
Version 2.0.0

# Open cmd.exe as admin and run:
powershell -noprofile -command &#34;Install-Module PSReadLine -Force&#34;

Get-Module PSReadLine
Version 2.2.6</code></pre>
</div>
</div>
]]></content:encoded>
    </item>
    
    <item>
      <title>Windows: Testing network connections</title>
      <link>https://www.andreaslongo.com/blog/windows-testing-network-connections/</link>
      <pubDate>Tue, 25 Jul 2023 00:00:00 +0000</pubDate>
      
      <guid>https://www.andreaslongo.com/blog/windows-testing-network-connections/</guid>
      <description>Verifying that one system can connect to another system via network is a common task for managing applications. A business application that is not interconnected to some other entity is hard to find.
This is a quick way to test some basic network connections on Windows without much dependencies. All you need is PowerShell and .NET which should already be included on most Windows hosts.
You create a custom TcpListener (which is an instance of a .</description>
      <content:encoded><![CDATA[<div class="paragraph">
<p>Verifying that one system can connect to another system via network is a common task for managing applications.
A business application that is not interconnected to some other entity is hard to find.</p>
</div>
<div class="paragraph">
<p>This is a quick way to test some basic network connections on Windows without much dependencies.
All you need is <em>PowerShell</em> and <em>.NET</em> which should already be included on most Windows hosts.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You create a custom <code>TcpListener</code> (which is an instance of a .NET class) to open up a port for TCP/IP connections.</p>
</li>
<li>
<p>Then, you connect to this port from a remote system to verify the connection at a basic level.</p>
</li>
<li>
<p>Reference: <a href="https://learn.microsoft.com/en-us/dotnet/api/system.net.sockets.tcplistener" class="bare">https://learn.microsoft.com/en-us/dotnet/api/system.net.sockets.tcplistener</a></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Create and start a custom listener (e.g. the server):</div>
<div class="content">
<pre class="highlight"><code class="language-powershell" data-lang="powershell">PS server&gt; $listener = [System.Net.Sockets.TcpListener]2383
PS server&gt; $listener.Start()

# Verify that ports are opened
PS server&gt; Get-NetTCPConnection -State Listen -LocalPort 2383

LocalAddress                        LocalPort RemoteAddress                       RemotePort State       AppliedSetting OwningProcess
------------                        --------- -------------                       ---------- -----       -------------- -------------
0.0.0.0                             2383      0.0.0.0                             0          Listen                     840</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Test the connection from a remote system (e.g. the client):</div>
<div class="content">
<pre class="highlight"><code class="language-powershell" data-lang="powershell">PS client&gt; Test-NetConnection &lt;server&gt; -Port 2383

ComputerName     : server
RemoteAddress    : 10.0.0.2
RemotePort       : 2383
InterfaceAlias   : 10.0.0.100
SourceAddress    : 10.0.0.100
TcpTestSucceeded : True</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Stop the listener when you are done:</div>
<div class="content">
<pre class="highlight"><code class="language-powershell" data-lang="powershell">PS server&gt; $listener.Stop()

# Verify that ports are closed
PS server&gt; Get-NetTCPConnection -State Listen -LocalPort 2383
Get-NetTCPConnection : No matching MSFT_NetTCPConnection objects found by CIM query for instances of the ROOT/StandardCimv2/MSFT_NetTCPConnection class on
the  CIM server: SELECT * FROM MSFT_NetTCPConnection  WHERE ((LocalPort = 2383)) AND ((State = 2)). Verify query parameters and retry.
    + CategoryInfo          : ObjectNotFound: (MSFT_NetTCPConnection:String) [Get-NetTCPConnection], CimJobException
    + FullyQualifiedErrorId : CmdletizationQuery_NotFound,Get-NetTCPConnection</code></pre>
</div>
</div>
]]></content:encoded>
    </item>
    
    <item>
      <title>Unix-like `watch` and `tail` commands for PowerShell</title>
      <link>https://www.andreaslongo.com/blog/powershell-watch/</link>
      <pubDate>Wed, 13 Apr 2022 00:00:00 +0000</pubDate>
      
      <guid>https://www.andreaslongo.com/blog/powershell-watch/</guid>
      <description>There is no equivalent to the Unix watch command on Windows, but you can get close enough behavior.
Watching commands with PowerShell # Similar to `watch &amp;lt;command&amp;gt;` PS&amp;gt; while ($true) {&amp;lt;your command&amp;gt;; sleep -Seconds 2} PS&amp;gt; while ($true) {(Get-Service -Name &amp;#39;Remote Desktop Services&amp;#39;).Status; sleep -Seconds 2} Running Running You can also follow log file output similar to the Unix tail command.
Tailing logs with PowerShell: # Similar to `tail --follow &amp;lt;filename&amp;gt;` PS&amp;gt; Get-Content -Path &amp;lt;logfile&amp;gt; -Tail 10 –Wait PS&amp;gt; Get-Content -Path &amp;#39;C:\app.</description>
      <content:encoded><![CDATA[<div class="paragraph">
<p>There is no equivalent to the Unix <a href="https://en.wikipedia.org/wiki/Watch_(command)"><code>watch</code></a> command on Windows, but you can get close enough behavior.</p>
</div>
<div class="listingblock">
<div class="title">Watching commands with PowerShell</div>
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash"># Similar to `watch &lt;command&gt;`
PS&gt; while ($true) {&lt;your command&gt;; sleep -Seconds 2}

PS&gt; while ($true) {(Get-Service -Name &#39;Remote Desktop Services&#39;).Status; sleep -Seconds 2}
Running
Running</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also follow log file output similar to the Unix <a href="https://en.wikipedia.org/wiki/Tail_(Unix)"><code>tail</code></a> command.</p>
</div>
<div class="listingblock">
<div class="title">Tailing logs with PowerShell:</div>
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash"># Similar to `tail --follow &lt;filename&gt;`
PS&gt; Get-Content -Path &lt;logfile&gt; -Tail 10 –Wait

PS&gt; Get-Content -Path &#39;C:\app.log&#39; -Tail 10 –Wait</code></pre>
</div>
</div>
]]></content:encoded>
    </item>
    
    <item>
      <title>Getting the uptime from Windows</title>
      <link>https://www.andreaslongo.com/blog/windows-get-uptime/</link>
      <pubDate>Wed, 17 Feb 2021 00:00:00 +0000</pubDate>
      
      <guid>https://www.andreaslongo.com/blog/windows-get-uptime/</guid>
      <description>I was looking for a uptime like command for Windows.
The uptime command on Linux: $ uptime 12:53:36 up 5:03, 1 user, load average: 0.83, 0.61, 0.36 $ uptime --pretty up 5 hours, 3 minutes $ uptime --since 2021-02-17 07:50:35 On Windows, there is the cmdlet Get-Uptime which is available for PowerShell version 6+.
$ Get-Uptime -Since Monday, January 18, 2021 7:56:57 AM If Get-Uptime is not available, you can query the WMI with a CIM cmdlet.</description>
      <content:encoded><![CDATA[<div class="paragraph">
<p>I was looking for a <code>uptime</code> like command for Windows.</p>
</div>
<div class="listingblock">
<div class="title">The <code>uptime</code> command on Linux:</div>
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ uptime
12:53:36 up  5:03,  1 user,  load average: 0.83, 0.61, 0.36

$ uptime --pretty
up 5 hours, 3 minutes

$ uptime --since
2021-02-17 07:50:35</code></pre>
</div>
</div>
<div class="paragraph">
<p>On Windows, there is the cmdlet <a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/get-uptime"><code>Get-Uptime</code></a> which is available for <a href="https://docs.microsoft.com/en-us/powershell/">PowerShell</a> version 6+.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ Get-Uptime -Since
Monday, January 18, 2021 7:56:57 AM</code></pre>
</div>
</div>
<div class="paragraph">
<p>If <code>Get-Uptime</code> is not available, you can query the WMI with a CIM cmdlet.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ Get-CimInstance -ClassName Win32_OperatingSystem | Select-Object LastBootUpTime

LastBootUpTime
--------------
18.01.2021 07:56:41</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>LastBootUpTime</code> value may not be updated if you have <em>fast boot/startup</em> enabled for your system.</p>
</div>
]]></content:encoded>
    </item>
    
  </channel>
</rss>
