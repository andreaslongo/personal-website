<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>PowerShell on Andreas Longo</title>
    <link>https://www.andreaslongo.com/tags/powershell/</link>
    <description>Recent content in PowerShell on Andreas Longo</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Wed, 13 Apr 2022 00:00:00 +0000</lastBuildDate><atom:link href="https://www.andreaslongo.com/tags/powershell/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Unix-like `watch` and `tail` commands for PowerShell</title>
      <link>https://www.andreaslongo.com/blog/powershell-watch/</link>
      <pubDate>Wed, 13 Apr 2022 00:00:00 +0000</pubDate>
      
      <guid>https://www.andreaslongo.com/blog/powershell-watch/</guid>
      <description>There is no equivalent to the Unix watch command on Windows, but you can get close enough behavior.
Watching commands with PowerShell # Similar to `watch &amp;lt;command&amp;gt;` PS&amp;gt; while ($true) {&amp;lt;your command&amp;gt;; sleep -Seconds 2} PS&amp;gt; while ($true) {(Get-Service -Name &amp;#39;Remote Desktop Services&amp;#39;).Status; sleep -Seconds 2} Running Running You can also follow log file output similar to the Unix tail command.
Tailing logs with PowerShell: # Similar to `tail --follow &amp;lt;filename&amp;gt;` PS&amp;gt; Get-Content -Path &amp;lt;logfile&amp;gt; -Tail 10 –Wait PS&amp;gt; Get-Content -Path &amp;#39;C:\app.</description>
      <content:encoded><![CDATA[<div class="paragraph">
<p>There is no equivalent to the Unix <a href="https://en.wikipedia.org/wiki/Watch_(command)"><code>watch</code></a> command on Windows, but you can get close enough behavior.</p>
</div>
<div class="listingblock">
<div class="title">Watching commands with PowerShell</div>
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash"># Similar to `watch &lt;command&gt;`
PS&gt; while ($true) {&lt;your command&gt;; sleep -Seconds 2}

PS&gt; while ($true) {(Get-Service -Name &#39;Remote Desktop Services&#39;).Status; sleep -Seconds 2}
Running
Running</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also follow log file output similar to the Unix <a href="https://en.wikipedia.org/wiki/Tail_(Unix)"><code>tail</code></a> command.</p>
</div>
<div class="listingblock">
<div class="title">Tailing logs with PowerShell:</div>
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash"># Similar to `tail --follow &lt;filename&gt;`
PS&gt; Get-Content -Path &lt;logfile&gt; -Tail 10 –Wait

PS&gt; Get-Content -Path &#39;C:\app.log&#39; -Tail 10 –Wait</code></pre>
</div>
</div>
]]></content:encoded>
    </item>
    
    <item>
      <title>Getting the uptime from Windows</title>
      <link>https://www.andreaslongo.com/blog/windows-get-uptime/</link>
      <pubDate>Wed, 17 Feb 2021 00:00:00 +0000</pubDate>
      
      <guid>https://www.andreaslongo.com/blog/windows-get-uptime/</guid>
      <description>I was looking for a uptime like command for Windows.
The uptime command on Linux: $ uptime 12:53:36 up 5:03, 1 user, load average: 0.83, 0.61, 0.36 $ uptime --pretty up 5 hours, 3 minutes $ uptime --since 2021-02-17 07:50:35 On Windows, there is the cmdlet Get-Uptime which is available for PowerShell version 6+.
$ Get-Uptime -Since Monday, January 18, 2021 7:56:57 AM If Get-Uptime is not available, you can query the WMI with a CIM cmdlet.</description>
      <content:encoded><![CDATA[<div class="paragraph">
<p>I was looking for a <code>uptime</code> like command for Windows.</p>
</div>
<div class="listingblock">
<div class="title">The <code>uptime</code> command on Linux:</div>
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ uptime
12:53:36 up  5:03,  1 user,  load average: 0.83, 0.61, 0.36

$ uptime --pretty
up 5 hours, 3 minutes

$ uptime --since
2021-02-17 07:50:35</code></pre>
</div>
</div>
<div class="paragraph">
<p>On Windows, there is the cmdlet <a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/get-uptime"><code>Get-Uptime</code></a> which is available for <a href="https://docs.microsoft.com/en-us/powershell/">PowerShell</a> version 6+.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ Get-Uptime -Since
Monday, January 18, 2021 7:56:57 AM</code></pre>
</div>
</div>
<div class="paragraph">
<p>If <code>Get-Uptime</code> is not available, you can query the WMI with a CIM cmdlet.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ Get-CimInstance -ClassName Win32_OperatingSystem | Select-Object LastBootUpTime

LastBootUpTime
--------------
18.01.2021 07:56:41</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>LastBootUpTime</code> value may not be updated if you have <em>fast boot/startup</em> enabled for your system.</p>
</div>
]]></content:encoded>
    </item>
    
  </channel>
</rss>
